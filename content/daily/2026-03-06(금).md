---
date: 2026-03-06
week: 2주차
phase: 백엔드 완성
tags: [lifespeech, planner, dev]
---

# 2026-03-06 (금) — 2주차 D5 · M2 검증일 🟢

> **근무:** 10:00 ~ 19:00 · 실 작업 **8시간**
> **목표:** Swagger + Postman Collection + Railway 최종 배포 + **M2 전체 검증**

---

## 시간 블록

| 시간 | 작업 | 예상 | 완료 기준 |
|------|------|------|-----------|
| 10:00–11:30 | @fastify/swagger 설정 | 1.5h | /docs → Swagger UI 표시 |
| 11:30–12:00 | 각 라우트 스키마 추가 (request/response) | 0.5h | Swagger에서 body 확인 가능 |
| 12:00–13:00 | 🍽️ 점심 | | |
| 13:00–14:00 | Postman Collection 완성 (38개) | 1h | Collection Runner 전체 통과 |
| 14:00–15:30 | Railway 최종 배포 + 환경변수 전체 확인 | 1.5h | Railway /health → 200 |
| 15:30–17:00 | **M2 마일스톤 전체 검증** | 1.5h | 아래 체크리스트 전부 통과 |
| 17:00–18:00 | 버그 수정 | 1h | |
| 18:00–18:30 | 소장님 보고 자료 (Railway URL + Swagger 링크) | 0.5h | |
| 18:30–19:00 | 2주차 회고 | 0.5h | |

---

## 작업 체크리스트

### Swagger 설정
- [ ] `@fastify/swagger` + `@fastify/swagger-ui` 설치 + 등록
  - 완료 기준: `{API}/docs` → 전체 API 목록 + Try it out 가능
- [ ] 주요 라우트 스키마: request body + response 타입 정의

### Postman Collection
- [ ] 38개 엔드포인트 모두 포함
  - 인증 4 + 회원 4 + 예약 4 (CSV 포함) + 반 3 + 등록 2 + 출석 3 + 파일 4 + SMS 2 + 스케줄 1 + 체크리스트 2 + 평가 2 + 상담 2 + 숙제 2 + 기타
  - 완료 기준: Collection Runner → 전체 통과

### Railway 최종 배포
- [ ] 환경변수 전체 확인 (SUPABASE_URL, SERVICE_KEY, JWT_SECRET, ALIGO 3개, OPENAI_API_KEY 예비)
- [ ] 최신 main 브랜치 push → Railway 자동 빌드 확인
- [ ] 빌드 성공 → `/health` 200 확인

### ✅ M2 마일스톤 검증 (15:30)
- [ ] CSV 업로드 실제 테스트 (네이버 CSV 5행)
  - Postman → `POST /reservations/csv-upload` → 파일 첨부 → 5건 생성 확인
- [ ] Supabase Storage 버킷 존재 + 파일 업로드 테스트
- [ ] SMS 실제 발송 → 내 폰에서 수신 확인 (SMS_TEST_MODE=N)
- [ ] Railway Swagger → `/docs` 접속 + 로그인 → 아무 GET 호출 확인

---

## 🤖 Claude 개발 요청 순서

### 요청 1 — Swagger 설정
```
Fastify에 Swagger 문서를 추가해줘.

패키지: @fastify/swagger, @fastify/swagger-ui
설정:
- openapi 버전: 3.0.3
- 제목: LifeSpeech API
- 버전: 1.0.0
- /docs 경로에 Swagger UI
- JWT Bearer 인증 스키마 추가 (securityDefinitions)

모든 라우트에 summary와 tags 추가.
인증이 필요한 라우트에 security: [{ bearerAuth: [] }] 추가.
```

### 요청 2 — Postman Collection 생성
```
현재까지 만든 전체 API 38개에 대한 Postman Collection을 JSON으로 만들어줘.

환경변수:
- BASE_URL: {{base_url}} (기본값: http://localhost:3000)
- ACCESS_TOKEN: {{access_token}}

포함 항목:
1. 인증 (4개): login, logout, me, refresh
2. 회원 (4개): list, create, detail, update
3. 예약 (4개): list, create, status-change, csv-upload
4. 반 (3개): list, create, update
5. 수강 (2개): create-enrollment, list-enrollments
6. 출석 (3개): list, update-status, close-session
7. 파일 (4개): upload, list, download, delete
8. SMS (2개): send, templates
9. 스케줄/체크리스트/평가/상담/숙제 (12개)

각 요청에 예시 body 포함.
login 요청 후 Tests 탭에: pm.environment.set("access_token", pm.response.json().accessToken); 추가.
```

### 요청 3 — 시드 데이터 완성 (시간 남으면)
```
테스트용 풀 시드 데이터 SQL을 만들어줘.

- 관리자 1명, 강사 2명, 회원 5명
- 반 2개 (그룹 수업, 1:1 수업)
- 수강 등록 5건 + attendances 자동 생성
- 예약 10건 (다양한 status)
- 상담 기록 3건

Supabase SQL Editor에서 실행 가능하게.
```

---

## ✅ 오늘 내가 직접 확인할 것 (M2 체크리스트)

**Swagger UI 확인 (브라우저)**
- [ ] `{Railway_URL}/docs` 접속 → API 목록 표시 확인
- [ ] Swagger에서 `POST /auth/login` 직접 실행 → 토큰 발급 확인
- [ ] Authorize 버튼 → 토큰 입력 → 아무 GET 엔드포인트 호출 → 200 확인

**CSV 업로드 실제 테스트**
- [ ] 네이버 CSV 샘플 파일 5행 준비
- [ ] Postman → `POST {Railway_URL}/reservations/csv-upload` → 파일 첨부 → 전송
- [ ] Supabase → reservations 테이블 → 5건 생성 확인

**Supabase Storage 확인**
- [ ] Storage → lifespeech-files 버킷 → 파일 존재 확인

**SMS 실제 발송 확인**
- [ ] Postman → `POST {Railway_URL}/sms/send` → 내 번호로 실제 발송 (SMS_TEST_MODE=N)
- [ ] **실제 문자 수신 확인** (안 되면 SMS 기능 전체 막힘 → 알리고 설정 재확인)

**→ 전부 통과 시 M2 완료 ✅**

**❌ 막혔을 때**
- SMS 발송 실패 → 알리고 API Key, 발신번호 등록 여부 재확인
- Railway 환경변수 누락 → Variables 탭에서 전체 확인

---

## 작업 로그

| 시간 | 작업 내용 | 비고 |
|------|-----------|------|
| 10:00 | | |
| 10:30 | | |
| 11:00 | | |
| 11:30 | | |
| 13:00 | | |
| 13:30 | | |
| 14:00 | | |
| 14:30 | | |
| 15:00 | | |
| 15:30 | M2 검증 시작 | |
| 16:00 | | |
| 16:30 | | |
| 17:00 | 버그 수정 | |
| 18:00 | 소장님 보고 자료 | |
| 18:30 | 2주차 회고 | |

---

## 메모 / 이슈

-

---

## 2주차 회고

**잘 된 것:**
-

**개선할 것:**
-

**M2 통과 여부:** [ ] ✅ 통과 / [ ] ❌ 미통과 (사유: )
