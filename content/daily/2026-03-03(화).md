---
date: 2026-03-03
week: 2ì£¼ì°¨
phase: ë°±ì—”ë“œ ì™„ì„±
tags: [lifespeech, planner, dev]
---

# 2026-03-03 (í™”) â€” 2ì£¼ì°¨ D2

> **ê·¼ë¬´:** 13:00 ~ 21:00 Â· ğŸ¤ ìŠ¤í”¼ì¹˜ ìˆ˜ì—… 19:30~21:00 Â· ì‹¤ ì‘ì—… **6ì‹œê°„**
> **ëª©í‘œ:** ìˆ˜ê°• ë“±ë¡ API + ì¶œì„ ì‹œìŠ¤í…œ API (ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ í¬í•¨)

---

## ì‹œê°„ ë¸”ë¡

| ì‹œê°„ | ì‘ì—… | ì˜ˆìƒ | ì™„ë£Œ ê¸°ì¤€ |
|------|------|------|-----------|
| 13:00â€“14:30 | POST /enrollments (ë“±ë¡ â†’ attendances ìë™ ìƒì„±) | 1.5h | ë“±ë¡ 1ê±´ â†’ attendances Ní–‰ í™•ì¸ |
| 14:30â€“15:30 | GET /enrollments í•„í„° + GET /attendance | 1h | 2ê°œ ì—”ë“œí¬ì¸íŠ¸ í†µê³¼ |
| 15:30â€“17:00 | PATCH /attendance/:id (ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ êµ¬í˜„) | 1.5h | 5ê°€ì§€ ìƒíƒœ ì „í™˜ ê·œì¹™ ì ìš© |
| 17:00â€“18:30 | POST /attendance/close-session (ë§ˆê°) | 1.5h | ë§ˆê° â†’ enrollment completed |
| 18:30â€“19:00 | ìŠ¤í”¼ì¹˜ ìˆ˜ì—… ì¤€ë¹„ | | |
| 19:30â€“21:00 | ğŸ¤ ìŠ¤í”¼ì¹˜ ìˆ˜ì—… | | |

---

## ì‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìˆ˜ê°• ë“±ë¡
- [ ] `POST /enrollments` â€” ë“±ë¡ â†’ attendances Ní–‰ ìë™ ìƒì„±
  - ì™„ë£Œ ê¸°ì¤€: ë“±ë¡ 1ê±´ â†’ attendances 7í–‰ (sessionsìˆ˜ë§Œí¼) í™•ì¸
- [ ] `GET /enrollments` â€” member_id, class_id í•„í„°

### ì¶œì„ ì‹œìŠ¤í…œ
- [ ] `GET /attendance` â€” ë°˜ë³„Â·íšŒì°¨ë³„Â·ë‚ ì§œë³„ í•„í„°
- [ ] `PATCH /attendance/:id` â€” ìƒíƒœ ë³€ê²½ + ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
  - ì˜ˆì •â†’ì¶œì„ / ì˜ˆì •â†’ì–‘í•´ / ì˜ˆì •â†’ì¡°ìœ¨ / ì˜ˆì •â†’ê²°ì„ / ì˜ˆì •â†’ë¹„ê³ 
  - ì¡°ìœ¨: makeup_used ì¹´ìš´íŠ¸ ì²´í¬ (1íšŒ ì´ˆê³¼ ì‹œ ê²½ê³ )
- [ ] `POST /attendance/close-session` â€” ì „ì²´ ë§ˆê°
  - enrollment status = completed

### ì¶œì„ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
```
ì˜ˆì • â†’ ì¶œì„: í•­ìƒ í—ˆìš© (íšŒì°¨ ì†Œì§„)
ì˜ˆì • â†’ ì–‘í•´: í•­ìƒ í—ˆìš© (íšŒì°¨ ì†Œì§„ ì•ˆ ë¨)
ì˜ˆì • â†’ ì¡°ìœ¨: ê²½ê³ ë§Œ (24h ì „ ì¡°ê±´), makeup_used=true, ë³´ê°• 1íšŒë§Œ
ì˜ˆì • â†’ ê²°ì„: íšŒì°¨ ì†Œì§„
ì˜ˆì • â†’ ë¹„ê³ : íšŒì°¨ ì†Œì§„ ì•ˆ ë¨
```

---

## ğŸ¤– Claude ê°œë°œ ìš”ì²­ ìˆœì„œ

### ìš”ì²­ 1 â€” ìˆ˜ê°• ë“±ë¡ API
```
ìˆ˜ê°• ë“±ë¡(enrollments) APIë¥¼ ë§Œë“¤ì–´ì¤˜. src/routes/enrollments.ts

1. POST /enrollments
   - body: { member_id, class_id, started_at }
   - classì˜ sessions ìˆ˜ë¥¼ ì¡°íšŒ
   - attendances í…Œì´ë¸”ì— sessions ìˆ˜ë§Œí¼ í–‰ ìë™ ìƒì„±
     (session_number: 1~N, status: 'scheduled', attended_at: null)
   - ì‘ë‹µ: 201 { enrollment, attendances_created: N }

2. GET /enrollments
   - query: member_id, class_id, status
   - ì‘ë‹µ: enrollments + class ì •ë³´ JOIN

requireRole('admin') ì ìš©.
```

### ìš”ì²­ 2 â€” ì¶œì„ API + ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™
```
ì¶œì„(attendance) APIë¥¼ ë§Œë“¤ì–´ì¤˜. src/routes/attendance.ts

1. GET /attendance
   - query: enrollment_id, class_id, session_number, date(YYYY-MM-DD)

2. PATCH /attendance/:id
   - body: { status, note? }
   - ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì ìš©:
     * 'attended': í•­ìƒ í—ˆìš©
     * 'excused': í•­ìƒ í—ˆìš©
     * 'adjusted': makeup_usedê°€ ì´ë¯¸ trueë©´ 400 ì—ëŸ¬ ("ë³´ê°•ì€ 1íšŒë§Œ ê°€ëŠ¥")
       makeup_used=trueë¡œ ì—…ë°ì´íŠ¸
     * 'absent': í•­ìƒ í—ˆìš©
     * 'note': í•­ìƒ í—ˆìš©

3. POST /attendance/close-session
   - body: { enrollment_id }
   - í•´ë‹¹ enrollmentì˜ ëª¨ë“  attendanceê°€ scheduled ì•„ë‹Œì§€ í™•ì¸
   - enrollment statusë¥¼ 'completed'ë¡œ ì—…ë°ì´íŠ¸

requireRole('admin', 'instructor') ì ìš©.
```

### ìš”ì²­ 3 â€” ì¶œì„ í†µê³„ (ì‹œê°„ ë‚¨ìœ¼ë©´)
```
GET /attendance/stats?enrollment_id={id}

ì‘ë‹µ:
{
  total_sessions: N,
  attended: N,
  excused: N,
  adjusted: N,
  absent: N,
  scheduled: N,
  attendance_rate: "85.7%"
}
```

---

## âœ… ì˜¤ëŠ˜ ë‚´ê°€ ì§ì ‘ í™•ì¸í•  ê²ƒ

**ìˆ˜ê°• ë“±ë¡ í…ŒìŠ¤íŠ¸ (Postman)**
- [ ] `POST {API}/enrollments` body: `{ "member_id": "...", "class_id": "...", "started_at": "2026-03-03" }`
  â†’ 201 + `{ "attendances_created": 7 }` í™•ì¸
- [ ] Supabase â†’ attendances í…Œì´ë¸” â†’ 7í–‰ ìë™ ìƒì„± í™•ì¸ (session_number 1~7)

**ì¶œì„ ìƒíƒœ ë³€ê²½ í…ŒìŠ¤íŠ¸**
- [ ] `PATCH {API}/attendance/{ID}` body: `{ "status": "attended" }` â†’ 200 í™•ì¸
- [ ] ê°™ì€ attendanceì— `{ "status": "adjusted" }` â†’ 200 í™•ì¸
- [ ] ë‹¤ì‹œ `{ "status": "adjusted" }` â†’ 400 "ë³´ê°•ì€ 1íšŒë§Œ" ì—ëŸ¬ í™•ì¸

**ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ í™•ì¸**
- [ ] Supabase â†’ attendances í…Œì´ë¸” â†’ makeup_used ì»¬ëŸ¼ trueë¡œ ì—…ë°ì´íŠ¸ëëŠ”ì§€ í™•ì¸

**âŒ ë§‰í˜”ì„ ë•Œ**
- attendances ìë™ ìƒì„± ì•ˆ ë¨ â†’ classes í…Œì´ë¸” sessions ê°’ í™•ì¸
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì˜¤ì‘ë™ â†’ Network íƒ­ â†’ ìš”ì²­/ì‘ë‹µ í™•ì¸ í›„ Claudeì—ê²Œ ì „ë‹¬

---

## ì‘ì—… ë¡œê·¸

| ì‹œê°„ | ì‘ì—… ë‚´ìš© | ë¹„ê³  |
|------|-----------|------|
| 13:00 | | |
| 13:30 | | |
| 14:00 | | |
| 14:30 | | |
| 15:00 | | |
| 15:30 | | |
| 16:00 | | |
| 16:30 | | |
| 17:00 | | |
| 17:30 | | |
| 18:00 | | |
| 18:30 | | |
| 19:00 | ìŠ¤í”¼ì¹˜ ì¤€ë¹„ | |
| 19:30 | ğŸ¤ ìŠ¤í”¼ì¹˜ ìˆ˜ì—… | |

---

## ë©”ëª¨ / ì´ìŠˆ

-
